archivesBaseName = "traverse-common"
version = formatVersion(project, "5.0.0")

loom {
	runs {
		datagen {
			server()

			name = "Data Generation"
			runDir = "build/datagen"

			vmArg("-Dfabric-api.datagen")
			vmArg("-Dfabric-api.datagen.output-dir=${file("src/main/generated")}")
		}
	}
}

// This is a sad, janky thing that Minecraft makes me do.
tasks.register('copyCommon', Copy) {
	from "src/main/generated/data/traverse-common"
	into "src/main/generated/data/traverse"
}
tasks.register('removeCommon', Delete) {
	delete "src/main/generated/data/traverse-common"
}
copyCommon.dependsOn(runDatagen)
removeCommon.dependsOn(copyCommon)
assemble.dependsOn(removeCommon)

sourceSets {
	main {
		resources {
			srcDirs += [
					"src/main/generated"
			]
		}
	}
}
